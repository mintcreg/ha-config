type: sections
max_columns: 1
subview: true
path: health
sections:
  - type: grid
    cards:
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            column_fix: true
            card_type: separator
            icon: mdi:list-status
            name: Health
            entity: person.craig_archbold
            card_mod:
              style: |
                .separator-container {
                        display: inline-flex;
                        align-items: center;
                        justify-content: center;
                        width: 100%;
                        margin-top: 12px;
                    }
                    .separator-container div:last-child {
                        display: none;
                    }
          - type: custom:bubble-card
            card_type: separator
            icon: mdi:battery
            name: Batteries
            card_mod:
              style: |
                .separator-container {
                        display: inline-flex;
                        width: 100%;
                        margin-top: 12px;
                    }
                    .separator-container div:last-child {
                        display: none;
                    }
          - type: horizontal-stack
            cards:
              - type: tile
                entity: input_boolean.battery_colourise
                name: Batteries
                icon: mdi:battery
                show_entity_picture: false
                vertical: true
                color: green
                tap_action:
                  action: navigate
                  navigation_path: "#batteries"
                icon_tap_action:
                  action: none
                hold_action:
                  action: none
                hide_state: true
              - type: custom:button-card
                color_type: blank-card
                card_mod:
                  style: |
                    ha-card {
                           margin-bottom: 5em;
                    }
            grid_options:
              columns: 12
              rows: 2
          - type: custom:bubble-card
            card_type: separator
            icon: mdi:access-point-network
            name: Network
            card_mod:
              style: |
                .separator-container {
                        display: inline-flex;
                        width: 100%;
                        margin-top: 12px;
                    }
                    .separator-container div:last-child {
                        display: none;
                    }
          - type: horizontal-stack
            cards:
              - type: tile
                entity: binary_sensor.aimesh_rt_ac86u_3c_7c_3f_61_c7_10
                name: Router
                icon: mdi:router-network-wireless
                show_entity_picture: false
                vertical: true
                color: green
                tap_action:
                  action: navigate
                  navigation_path: "#router"
                icon_tap_action:
                  action: none
                hold_action:
                  action: none
                hide_state: true
              - type: custom:button-card
                color_type: blank-card
                card_mod:
                  style: |
                    ha-card {
                           margin-bottom: 5em;
                    }
            grid_options:
              columns: 12
              rows: 2
          - type: custom:bubble-card
            card_type: separator
            icon: phu:desktop-computer
            name: PC Statuses
            card_mod:
              style: |
                .separator-container {
                        display: inline-flex;
                        width: 100%;
                        margin-top: 12px;
                    }
                    .separator-container div:last-child {
                        display: none;
                    }
          - type: horizontal-stack
            cards:
              - type: tile
                entity: switch.craig_pc
                name: Craig's PC
                icon: phu:rooms-computer
                show_entity_picture: false
                vertical: true
                color: green
                tap_action:
                  action: navigate
                  navigation_path: "#craig-pc"
                icon_tap_action:
                  action: none
                hold_action:
                  action: none
                hide_state: true
              - type: tile
                entity: switch.server
                name: Server
                icon: mdi:server
                show_entity_picture: false
                vertical: true
                color: green
                tap_action:
                  action: navigate
                  navigation_path: "#server"
                icon_tap_action:
                  action: none
                hold_action:
                  action: none
                hide_state: true
            grid_options:
              columns: 12
              rows: 2
          - type: horizontal-stack
            cards:
              - type: tile
                entity: binary_sensor.rpi_power_status
                name: Raspberry PI
                icon: mdi:raspberry-pi
                show_entity_picture: false
                vertical: true
                card_mod:
                  style: |
                    ha-card {
                      {% if is_state('binary_sensor.rpi_power_status', 'off') %}
                        --tile-color: var(--green-color) !important;
                      {% endif %}
                    }
                tap_action:
                  action: navigate
                  navigation_path: "#ha"
                icon_tap_action:
                  action: none
                hold_action:
                  action: none
                hide_state: true
              - type: custom:button-card
                color_type: blank-card
                card_mod:
                  style: |
                    ha-card {
                           margin-bottom: 5em;
                    }
            grid_options:
              columns: 12
              rows: 2
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#batteries"
            show_header: true
            name: ""
            show_icon: false
            show_attribute: false
            show_state: true
            show_last_changed: false
            tap_action:
              action: none
            double_tap_action:
              action: none
            hold_action:
              action: none
            button_action:
              tap_action:
                action: none
              double_tap_action:
                action: none
              hold_action:
                action: none
            scrolling_effect: true
            styles: |-
              .bubble-header .bubble-name-container {
                align-items: center;
              }

              }
            auto_close: ""
            hide_backdrop: false
            button_type: name
            show_name: true
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                column_fix: true
                card_type: separator
                icon: mdi:battery
                name: Batteries
                entity: person.craig_archbold
                card_mod:
                  style: |
                    .separator-container {
                            display: inline-flex;
                            align-items: center;
                            justify-content: center;
                            width: 100%;
                            margin-top: 12px;
                        }
                        .separator-container div:last-child {
                            display: none;
                        }

                        
              - type: custom:stack-in-card
                title: Battery Levels
                card_mod:
                  style: |
                    h1 {
                      padding-bottom: 0px
                    }
                cards:
                  - type: entities
                    card_mod:
                      style:
                        .: |
                          #states {
                            padding-top: 0px;
                            padding-bottom: 0px;
                          }
                        "#states fold-entity-row":
                          $:
                            "#items":
                              hui-input-number-entity-row,hui-toggle-entity-row:
                                $:
                                  hui-generic-entity-row$: |
                                    state-badge {
                                      display: none;
                                    }
                                    state-badge + div {
                                      margin-left: 8px !important;
                                    }
                    entities:
                      - type: custom:fold-entity-row
                        head:
                          type: section
                          label: Thresholds
                        padding: 0
                        entities:
                          - entity: input_number.battery_low
                            name: Low Battery (Higher Threshold)
                          - entity: input_number.battery_high
                            name: Full Battery (Lower Threshold)
                      - type: custom:fold-entity-row
                        head:
                          type: section
                          label: Options
                        padding: 0
                        entities:
                          - entity: input_boolean.battery_hide_full
                            name: Hide Full Batteries
                          - entity: input_boolean.battery_hide_above_low
                            name: Only Show Low Batteries
                          - entity: input_boolean.battery_colourise
                            name: Color States
                  - type: custom:auto-entities
                    card:
                      type: entities
                      card_mod:
                        style: |
                          #states {
                            padding-top: 0px;
                          }
                    entities:
                      - type: section
                        label: States
                    filter:
                      template: >
                        {% set ret = namespace(entities={}, final=[]) %} {% set
                        exclude_list = [
                            'sensor.tessy_battery_range', 
                            'sensor.angela_s_phone_battery_state',
                            'sensor.craig_s_phone_battery_state',
                            'binary_sensor.tessy_battery_heater_2',
                            'binary_sensor.back_door_sensor_battery_low',
                            'binary_sensor.loft_hatch_sensor_battery_low',
                            'binary_sensor.front_door_sensor_battery_low',
                            'sensor.angela_s_phone_battery_level',
                            'sensor.tessy_battery_level',
                            'sensor.craig_s_phone_battery_level'
                        ] %}  {# Replace with your actual entity IDs to exclude
                        #}


                        {% for entity in states if 'battery' in entity.entity_id
                        and entity.domain in ['sensor', 'binary_sensor'] %}
                          {% if entity.entity_id in exclude_list %}
                            {% continue %}
                          {% endif %}
                          
                          {% set incl = True %}
                          {% if is_state('input_boolean.battery_hide_full', 'on') %}
                            {% if states(entity.entity_id) | int(254) >= (states('input_number.battery_high') | int) %}
                              {% set incl = False %}
                            {% endif %}
                          {% endif %}
                          {% if is_state('input_boolean.battery_hide_above_low', 'on') and states(entity.entity_id) | int(254) >= (states('input_number.battery_low') | int) %}
                            {% set incl = False %}
                          {% endif %}
                          
                          {% if incl %}
                              {% set ret.entities = dict(ret.entities, **{entity.entity_id: entity.state | int(254)}) %}
                          {% endif %}
                        {% endfor %}

                        {% for key, value in ret.entities | dictsort(false,
                        'value') %}
                          {% set final = {'entity': key, 'name': (state_attr(key, 'friendly_name') | regex_replace(find='(battery|level)', replace='', ignorecase=True)).strip()} %}
                          {% if is_state('input_boolean.battery_colourise', 'on') %}
                            {% set style = ':host {color: ' %}
                            {% set colour = 'green' %}
                            {% if value < states('input_number.battery_high') | int %}
                              {% set colour = 'orange' %}
                            {% endif %}
                            {% if value < states('input_number.battery_low') | int %}
                              {% set colour = 'red' %}
                            {% endif %}
                            {% set css = {'style':  style ~ colour ~ '; --paper-item-icon-color: ' ~ colour ~ ';}'} %}
                            {% set final = dict(final, **{'card_mod': css}) %}
                          {% endif %}
                          {% set ret.final = ret.final + [final] %}
                        {% endfor %} {{ ret.final }}
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#router"
            show_header: true
            name: ""
            show_icon: false
            show_attribute: false
            show_state: true
            show_last_changed: false
            tap_action:
              action: none
            double_tap_action:
              action: none
            hold_action:
              action: none
            button_action:
              tap_action:
                action: none
              double_tap_action:
                action: none
              hold_action:
                action: none
            scrolling_effect: true
            styles: |-
              .bubble-header .bubble-name-container {
                align-items: center;
              }

              }
            auto_close: ""
            hide_backdrop: false
            button_type: name
            show_name: true
          - type: custom:bubble-card
            column_fix: true
            card_type: separator
            icon: mdi:router-network-wireless
            name: Router Monitor
            entity: person.craig_archbold
            card_mod:
              style: |
                .separator-container {
                        display: inline-flex;
                        align-items: center;
                        justify-content: center;
                        width: 100%;
                        margin-top: 12px;
                    }
                    .separator-container div:last-child {
                        display: none;
                    }
          - type: conditional
            conditions:
              - condition: state
                entity: binary_sensor.rt_ac86u_wan
                state_not: unknown
              - condition: state
                entity: binary_sensor.rt_ac86u_wan
                state_not: unknown
            card:
              type: custom:vertical-stack-in-card
              cards:
                - type: horizontal-stack
                  cards:
                    - type: custom:mini-graph-card
                      entities:
                        - sensor.rt_ac86u_cpu
                      name: CPU
                      line_color: "#3123b9"
                      line_width: 2
                      hours_to_show: 24
                    - type: custom:mini-graph-card
                      entities:
                        - sensor.rt_ac86u_temperature_cpu
                      name: Temp
                      line_color: "#d080b9"
                      line_width: 2
                      hours_to_show: 24
                - type: custom:mini-graph-card
                  entities:
                    - sensor.rt_ac86u_ram
                  name: Memory
                  line_color: "#2980b9"
                  line_width: 2
                  hours_to_show: 24
                - type: custom:bar-card
                  name: CPU
                  positions:
                    icon: outside
                    name: inside
                  color: "#3123b9"
                  entities:
                    - entity: sensor.rt_ac86u_cpu
                - type: custom:bar-card
                  name: Clients
                  positions:
                    icon: outside
                    name: inside
                  color: "#00ba6a"
                  entities:
                    - entity: sensor.rt_ac86u_connected_devices
                - type: custom:bar-card
                  name: RAM
                  positions:
                    icon: outside
                    name: inside
                  entities:
                    - entity: sensor.rt_ac86u_ram
          - type: conditional
            conditions:
              - condition: state
                entity: binary_sensor.rt_ac86u_wan
                state_not: unknown
              - condition: state
                entity: binary_sensor.rt_ac86u_wan
                state_not: unknown
            card:
              type: vertical-stack
              cards:
                - type: custom:expander-card
                  gap: 0.6em
                  padding: 1em
                  clear: false
                  clear-children: true
                  title: Status
                  overlay-margin: 2em
                  child-padding: 0.5em
                  button-background: transparent
                  header-color: "#FF5733"
                  cards:
                    - type: entities
                      entities:
                        - entity: binary_sensor.rt_ac86u_internet
                          name: Internet Status
                        - entity: switch.rt_ac86u_openvpn_server_2
                          secondary_info: none
                          name: VPN (All Access)
                        - entity: switch.rt_ac86u_guest_2_4_ghz_1
                          name: Guest WiFi
                  entities:
                    - entity: binary_sensor.rt_ac86u_internet
                      name: Internet Status
                    - entity: switch.rt_ac86u_openvpn_server_2
                      secondary_info: none
                      name: VPN (All Access)
                  card_mod:
                    style: |
                      .header {
                        color: white;  /* Custom header text color */
                        font-weight: bold;  /* Make the text bold */
                        font-size: 18px;  /* Adjust font size */
                      }
                      .primary.title.svelte-1n379ek {
                        text-align: center;  /* Center-align the specific div text */
                      }
                - type: custom:expander-card
                  gap: 0.6em
                  padding: 1em
                  clear: true
                  clear-children: true
                  title: Quick Controls
                  overlay-margin: 2em
                  child-padding: 0.5em
                  button-background: transparent
                  header-color: "#FF5733"
                  cards:
                    - type: horizontal-stack
                      cards:
                        - show_name: true
                          show_icon: true
                          type: button
                          tap_action:
                            action: toggle
                          entity: button.rt_ac86u_reboot
                          name: Reboot Router
                          icon: mdi:router-network
                        - show_name: true
                          show_icon: true
                          type: button
                          tap_action:
                            action: toggle
                          entity: button.rt_ac86u_restart_wireless
                          name: Reboot Wireless
                          icon: mdi:router-wireless-settings
                  entities:
                    - entity: binary_sensor.rt_ac86u_internet
                      name: Internet Status
                    - entity: switch.rt_ac86u_openvpn_server_2
                      secondary_info: none
                      name: VPN (All Access)
                  card_mod:
                    style: |
                      .header {
                        color: white;  /* Custom header text color */
                        font-weight: bold;  /* Make the text bold */
                        font-size: 18px;  /* Adjust font size */
                      }
                      .primary.title.svelte-1n379ek {
                        text-align: center;  /* Center-align the specific div text */
                      }
          - type: conditional
            conditions:
              - condition: state
                entity: binary_sensor.rt_ac86u_wan
                state: unknown
              - condition: state
                entity: binary_sensor.rt_ac86u_wan
                state: unknown
            card:
              type: markdown
              content: "**The router is offline!**"
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#craig-pc"
            show_header: true
            name: ""
            show_icon: false
            show_attribute: false
            show_state: true
            show_last_changed: false
            tap_action:
              action: none
            double_tap_action:
              action: none
            hold_action:
              action: none
            button_action:
              tap_action:
                action: none
              double_tap_action:
                action: none
              hold_action:
                action: none
            scrolling_effect: true
            styles: |-
              .bubble-header .bubble-name-container {
                align-items: center;
              }

              }
            auto_close: ""
            hide_backdrop: false
            button_type: name
            show_name: true
          - type: custom:bubble-card
            column_fix: true
            card_type: separator
            icon: phu:desktop-computer
            name: PC Monitor
            entity: person.craig_archbold
            card_mod:
              style: |
                .separator-container {
                        display: inline-flex;
                        align-items: center;
                        justify-content: center;
                        width: 100%;
                        margin-top: 12px;
                    }
                    .separator-container div:last-child {
                        display: none;
                    }
          - type: conditional
            conditions:
              - condition: and
                conditions:
                  - condition: state
                    entity: sensor.mint_battlestation_gpuload_2
                    state_not: unavailable
                  - condition: state
                    entity: sensor.mint_battlestation_gpuload_2
                    state_not: unknown
            card:
              type: custom:vertical-stack-in-card
              cards:
                - type: horizontal-stack
                  cards:
                    - type: custom:mini-graph-card
                      entities:
                        - sensor.rt_ac86u_cpu
                      name: CPU
                      line_color: "#3123b9"
                      line_width: 2
                      hours_to_show: 24
                    - type: custom:mini-graph-card
                      entities:
                        - sensor.mint_battlestation_gputemperature_2
                      name: GPU Temp
                      line_color: "#d080b9"
                      line_width: 2
                      hours_to_show: 24
                - type: custom:mini-graph-card
                  entities:
                    - sensor.mint_battlestation_memoryusage_2
                  name: Memory
                  line_color: "#2980b9"
                  line_width: 2
                  hours_to_show: 24
                - type: custom:bar-card
                  name: GPU
                  positions:
                    icon: outside
                    name: inside
                  color: "#00ba6a"
                  entities:
                    - entity: sensor.mint_battlestation_gpuload_2
                - type: custom:bar-card
                  name: RAM
                  positions:
                    icon: outside
                    name: inside
                  entities:
                    - entity: sensor.mint_battlestation_memoryusage_2
                - type: custom:bar-card
                  positions:
                    icon: outside
                    name: inside
                  entities:
                    - entity: sensor.mint_battlestation_storage_c_2
                      attribute: UsedSpacePercentage
                      name: C Drive
                      min: 0
                      max: 100
                      unit_of_measurement: "%"
                - type: custom:bar-card
                  positions:
                    icon: outside
                    name: inside
                  color: "#00ba6a"
                  entities:
                    - entity: sensor.mint_battlestation_storage_d_2
                      attribute: UsedSpacePercentage
                      name: Backups
                      min: 0
                      max: 100
                      unit_of_measurement: "%"
                - type: custom:mushroom-template-card
                  secondary: |+
                    {{ states ('sensor.mint_battlestation_sessionstate') }} 

                  icon: phu:desktop-computer
                  entity: sensor.mint_battlestation_sessionstate
                  primary: PC Status
                  multiline_secondary: true
                  icon_color: >-
                    {% if states('sensor.mint_battlestation_sessionstate') ==
                    'Unlocked' %}
                        green
                      {% else %}
                        red
                      {% endif %}
                  badge_icon: >-
                    {% if states('sensor.mint_battlestation_sessionstate') ==
                    'Unlocked' %}
                        mdi:check
                      {% else %}
                        mdi:alert
                      {% endif %}
                  fill_container: true
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  layout: vertical
                  card_mod:
                    style:
                      mushroom-state-info$: |
                        .container {
                         --card-secondary-font-size: 11px;
                         --card-secondary-font-weight: bold;
                         --card-primary-font-weight: ;
                         }
          - type: conditional
            conditions:
              - condition: state
                entity: sensor.mint_battlestation_gpuload_2
                state: unavailable
              - condition: state
                entity: switch.craig_pc
                state: "on"
            card:
              type: vertical-stack
              cards:
                - type: markdown
                  content: >-
                    The PC is currently turned on **but** Hass Agent hasn't been
                    started.


                    Please turn on Hass Agent and this screen will update
                  card_mod:
                    style:
                      mushroom-shape-avatar$: |
                        .picture {
                          /* Style shadow ring around person avatar */                              
                          box-shadow: 0px 0px 8px 4px var(--state-person);
                          margin-right: var(--mush-title-spacing, 12px);
                          }
                      .: |
                        ha-card {
                          /* Remove default card styling */
                          --ha-card-background: rgba(var(--rgb-card-background-color), 0.);;
                          box-shadow: none;
                          --ha-card-border-width: 0;
                          /* Increase icon size */
                          --icon-size: 80px;
                          /* Center card */
                          margin: 25px 0px 0px 30px;
                          width: fit-content;
                          /* Add padding to bottom of card */
                          padding: 0px 0px var(--mush-title-spacing, 12px) 0px !important;
                          
                          /* Make card non-responsive to select and pointer */
                          user-select: none;
                          pointer-events: none;
                          
                          transition: all 0s;
                        }
                        :host {
                          /* Define Person State colors. Can be added to theme */
                          --state-person-home: var(--green-color);
                          --state-person-not-home: var(--red-color);
                          --state-person-zone: var(--blue-color);
                          --state-person-unknown: var(--grey-color);
                          /* Set Person State color */
                          --state-person:
                          {% if is_state(config.entity, ['home', 'not_home', 'unknown']) %}
                            var(--state-person-{{ states(config.entity) | replace('_', '-') }})
                          {% else %}
                            var(--state-person-zone)
                          {% endif %};
                          /* Match styling to Mushroom Title */
                          --mush-card-primary-font-size: var(--mush-title-font-size, 24px);
                          --mush-card-primary-font-weight: var(--mush-title-font-weight, normal);
                          --mush-card-primary-line-height: var(--ush-title-line-height, 1.2);
                          --mush-card-secondary-font-size: var(--mush-title-font-size, 16px);
                          --mush-card-secondary-font-weight: var(--mush-title-font-weight, normal);
                          --mush-card-secondary-line-height: var(--ush-title-line-height, 1.2);
                        }
          - type: conditional
            conditions:
              - condition: and
                conditions:
                  - condition: state
                    entity: sensor.mint_battlestation_gpuload_2
                    state_not: unavailable
                  - condition: state
                    entity: sensor.mint_battlestation_gpuload_2
                    state_not: unknown
                  - condition: state
                    entity: switch.craig_pc
                    state_not: "on"
            card:
              type: vertical-stack
              cards:
                - type: markdown
                  content: >-
                    The PC is currently **turned off!**


                    You can use the button below to turn this on and the screen
                    will automatically refresh
                  card_mod:
                    style:
                      mushroom-shape-avatar$: |
                        .picture {
                          /* Style shadow ring around person avatar */                              
                          box-shadow: 0px 0px 8px 4px var(--state-person);
                          margin-right: var(--mush-title-spacing, 12px);
                          }
                      .: |
                        ha-card {
                          /* Remove default card styling */
                          --ha-card-background: rgba(var(--rgb-card-background-color), 0.);;
                          box-shadow: none;
                          --ha-card-border-width: 0;
                          /* Increase icon size */
                          --icon-size: 80px;
                          /* Center card */
                          margin: 25px 0px 0px 30px;
                          width: fit-content;
                          /* Add padding to bottom of card */
                          padding: 0px 0px var(--mush-title-spacing, 12px) 0px !important;
                          
                          /* Make card non-responsive to select and pointer */
                          user-select: none;
                          pointer-events: none;
                          
                          transition: all 0s;
                        }
                        :host {
                          /* Define Person State colors. Can be added to theme */
                          --state-person-home: var(--green-color);
                          --state-person-not-home: var(--red-color);
                          --state-person-zone: var(--blue-color);
                          --state-person-unknown: var(--grey-color);
                          /* Set Person State color */
                          --state-person:
                          {% if is_state(config.entity, ['home', 'not_home', 'unknown']) %}
                            var(--state-person-{{ states(config.entity) | replace('_', '-') }})
                          {% else %}
                            var(--state-person-zone)
                          {% endif %};
                          /* Match styling to Mushroom Title */
                          --mush-card-primary-font-size: var(--mush-title-font-size, 24px);
                          --mush-card-primary-font-weight: var(--mush-title-font-weight, normal);
                          --mush-card-primary-line-height: var(--ush-title-line-height, 1.2);
                          --mush-card-secondary-font-size: var(--mush-title-font-size, 16px);
                          --mush-card-secondary-font-weight: var(--mush-title-font-weight, normal);
                          --mush-card-secondary-line-height: var(--ush-title-line-height, 1.2);
                        }
                - type: custom:bubble-card
                  card_type: button
                  button_type: switch
                  entity: switch.craig_pc
                  icon: phu:desktop-computer
                  show_state: true
                  name: PC
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#server"
            show_header: true
            name: ""
            show_icon: false
            show_attribute: false
            show_state: true
            show_last_changed: false
            tap_action:
              action: none
            double_tap_action:
              action: none
            hold_action:
              action: none
            button_action:
              tap_action:
                action: none
              double_tap_action:
                action: none
              hold_action:
                action: none
            scrolling_effect: true
            styles: |-
              .bubble-header .bubble-name-container {
                align-items: center;
              }

              }
            auto_close: ""
            hide_backdrop: false
            button_type: name
            show_name: true
          - type: custom:bubble-card
            column_fix: true
            card_type: separator
            icon: mdi:server-network
            name: Server Monitor
            entity: person.craig_archbold
            card_mod:
              style: |
                .separator-container {
                        display: inline-flex;
                        align-items: center;
                        justify-content: center;
                        width: 100%;
                        margin-top: 12px;
                    }
                    .separator-container div:last-child {
                        display: none;
                    }
          - type: conditional
            conditions:
              - condition: and
                conditions:
                  - condition: state
                    entity: sensor.unraid_server_mazmaka_mazmaka_cpu_usage
                    state_not: unavailable
                  - condition: state
                    entity: sensor.unraid_server_mazmaka_mazmaka_cpu_usage
                    state_not: unknown
            card:
              type: vertical-stack
              cards:
                - type: custom:bubble-card
                  column_fix: true
                  card_type: separator
                  icon: mdi:chip
                  name: CPU Metrics
                  entity: sensor.unraid_server_mazmaka_mazmaka_cpu_usage
                  card_mod:
                    style: |
                      .separator-container {
                        display: inline-flex;
                        align-items: center;
                        justify-content: center;
                        width: 100%;
                        margin-top: 12px;
                      }
                      .separator-container div:last-child {
                        display: none;
                      }
                - type: custom:vertical-stack-in-card
                  cards:
                    - type: horizontal-stack
                      cards:
                        - type: custom:mini-graph-card
                          entities:
                            - sensor.unraid_server_mazmaka_mazmaka_cpu_usage
                          name: CPU
                          line_color: "#3123b9"
                          line_width: 2
                          hours_to_show: 24
                        - type: custom:mini-graph-card
                          entities:
                            - >-
                              sensor.unraid_server_mazmaka_mazmaka_cpu_temperature
                          name: CPU Temp
                          line_color: "#d080b9"
                          line_width: 2
                          hours_to_show: 24
                    - type: custom:mini-graph-card
                      entities:
                        - sensor.unraid_server_mazmaka_mazmaka_ram_usage
                      name: Memory
                      line_color: "#2980b9"
                      line_width: 2
                      hours_to_show: 24
                    - type: custom:bar-card
                      name: RAM
                      color: "#2980b9"
                      positions:
                        icon: outside
                        name: inside
                      entities:
                        - entity: sensor.unraid_server_mazmaka_mazmaka_ram_usage
                    - type: custom:bar-card
                      positions:
                        icon: outside
                        name: inside
                      color: "#3123b9"
                      entities:
                        - entity: sensor.unraid_server_mazmaka_mazmaka_cpu_usage
                          name: CPU
                          min: 0
                          max: 100
                          unit_of_measurement: "%"
                    - type: custom:bar-card
                      positions:
                        icon: outside
                        name: inside
                      color: "#d080b9"
                      entities:
                        - entity: sensor.unraid_server_mazmaka_mazmaka_cpu_temperature
                          name: CPU Temp
                          min: 0
                          max: 100
                          unit_of_measurement: "%"
                - type: vertical-stack
                  cards:
                    - type: custom:bubble-card
                      column_fix: true
                      card_type: separator
                      icon: mdi:network
                      name: Network Traffic
                      entity: sensor.unraid_server_mazmaka_mazmaka_bond0_inbound
                      card_mod:
                        style: |
                          .separator-container {
                            display: inline-flex;
                            align-items: center;
                            justify-content: center;
                            width: 100%;
                            margin-top: 12px;
                          }
                          .separator-container div:last-child {
                            display: none;
                          }
                - type: custom:vertical-stack-in-card
                  cards:
                    - type: custom:bar-card
                      positions:
                        icon: outside
                        name: inside
                      color: "#1E90FF"
                      entities:
                        - entity: sensor.unraid_server_mazmaka_mazmaka_eth0_inbound
                          name: Inbound
                          min: 0
                          max: 100
                          unit_of_measurement: "%"
                    - type: custom:bar-card
                      positions:
                        icon: outside
                        name: inside
                      color: "#FF4500"
                      entities:
                        - entity: sensor.unraid_server_mazmaka_mazmaka_eth0_outbound
                          name: Outbound
                          min: 0
                          max: 100
                          unit_of_measurement: "%"
                - type: vertical-stack
                  cards:
                    - type: custom:bubble-card
                      column_fix: true
                      card_type: separator
                      icon: mdi:harddisk
                      name: Storage Metrics
                      entity: sensor.unraid_server_mazmaka_mazmaka_array_usage
                      card_mod:
                        style: |
                          .separator-container {
                            display: inline-flex;
                            align-items: center;
                            justify-content: center;
                            width: 100%;
                            margin-top: 12px;
                          }
                          .separator-container div:last-child {
                            display: none;
                          }
                - type: custom:vertical-stack-in-card
                  cards:
                    - type: custom:bar-card
                      positions:
                        icon: outside
                        name: inside
                      color: "#8A2BE2"
                      entities:
                        - entity: sensor.unraid_server_mazmaka_mazmaka_array_usage
                          name: Array Size
                          min: 0
                          max: 100
                          unit_of_measurement: "%"
                    - type: custom:bar-card
                      positions:
                        icon: outside
                        name: inside
                      color: "#42a5f5"
                      entities:
                        - entity: >-
                            sensor.unraid_server_mazmaka_mazmaka_pool_cache_usage
                          name: Cache Disk
                          min: 0
                          max: 100
                          unit_of_measurement: "%"
                    - type: custom:bar-card
                      positions:
                        icon: outside
                        name: inside
                      color: "#00ba6a"
                      entities:
                        - entity: >-
                            sensor.unraid_server_mazmaka_mazmaka_docker_vdisk_usage
                          name: Docker Disk
                          min: 0
                          max: 100
                          unit_of_measurement: "%"
                - type: custom:expander-card
                  gap: 0.6em
                  padding: 1em
                  clear: true
                  clear-children: true
                  title: ""
                  overlay-margin: 2em
                  child-padding: 0.5em
                  button-background: transparent
                  header-color: "#FF5733"
                  cards:
                    - type: vertical-stack
                      cards:
                        - type: custom:auto-entities
                          card:
                            type: entities
                            show_header_toggle: false
                          filter:
                            include:
                              - entity_id: >-
                                  sensor.unraid_server_mazmaka_mazmaka_array_disk*_usage
                                options:
                                  type: custom:template-entity-row
                                  name: >
                                    {{ state_attr(config.entity, 'mount_point')
                                    }}
                                  state: |
                                    {{ states(config.entity) }}%
                          sort:
                            method: name
                            numeric: true
                  entities:
                    - entity: binary_sensor.rt_ac86u_internet
                      name: Internet Status
                    - entity: switch.rt_ac86u_openvpn_server_2
                      secondary_info: none
                      name: VPN (All Access)
                  title-card:
                    type: custom:bubble-card
                    column_fix: true
                    card_type: separator
                    icon: mdi:harddisk
                    name: Array Disks
                    entity: sensor.unraid_server_mazmaka_mazmaka_array_disk1_usage
                    card_mod:
                      style: |
                        .separator-container {
                          display: inline-flex;
                          align-items: center;
                          justify-content: center;
                          width: 100%;
                          margin-top: 12px;
                        }
                        .separator-container div:last-child {
                          display: none;
                        }
                  card_mod:
                    style: |
                      .header {
                        color: white;  /* Custom header text color */
                        font-weight: bold;  /* Make the text bold */
                        font-size: 18px;  /* Adjust font size */
                      }
                      .primary.title.svelte-1n379ek {
                        text-align: center;  /* Center-align the specific div text */
                      }
                - type: custom:expander-card
                  gap: 0.6em
                  padding: 1em
                  clear: true
                  clear-children: true
                  title: ""
                  overlay-margin: 2em
                  child-padding: 0.5em
                  button-background: transparent
                  header-color: "#FF5733"
                  cards:
                    - type: vertical-stack
                      cards:
                        - type: custom:auto-entities
                          card:
                            type: entities
                            show_header_toggle: false
                          filter:
                            include:
                              - domain: switch
                                entity_id: switch.unraid_server_mazmaka_mazmaka_docker_*
                                options:
                                  type: custom:template-entity-row
                                  name: |
                                    {{ state_attr(config.entity, 'image') }}
                                  toggle: true
                          card_options:
                            show_header_toggle: false
                          customize:
                            - entity: switch.unraid_server_mazmaka_mazmaka_docker_*
                              name: |
                                [[[ 
                                  return entity.attributes.friendly_name.replace(/^Unraid Server \(Mazmaka\) Mazmaka Docker\s*/, '');
                                ]]]
                  entities:
                    - entity: binary_sensor.rt_ac86u_internet
                      name: Internet Status
                    - entity: switch.rt_ac86u_openvpn_server_2
                      secondary_info: none
                      name: VPN (All Access)
                  title-card:
                    type: custom:bubble-card
                    column_fix: true
                    card_type: separator
                    icon: mdi:docker
                    name: Docker Containers
                    entity: switch.unraid_server_mazmaka_mazmaka_docker_swag
                    card_mod:
                      style: |
                        .separator-container {
                          display: inline-flex;
                          align-items: center;
                          justify-content: center;
                          width: 100%;
                          margin-top: 12px;
                        }
                        .separator-container div:last-child {
                          display: none;
                        }
                  card_mod:
                    style: |
                      .header {
                        color: white;  /* Custom header text color */
                        font-weight: bold;  /* Make the text bold */
                        font-size: 18px;  /* Adjust font size */
                      }
                      .primary.title.svelte-1n379ek {
                        text-align: center;  /* Center-align the specific div text */
                      }
                - type: custom:expander-card
                  gap: 0.6em
                  padding: 1em
                  clear: true
                  clear-children: true
                  title: ""
                  overlay-margin: 2em
                  child-padding: 0.5em
                  button-background: transparent
                  header-color: "#FF5733"
                  cards:
                    - type: vertical-stack
                      cards:
                        - show_name: true
                          show_icon: true
                          type: button
                          name: Shutdown Unraid Server
                          icon: mdi:power
                          tap_action:
                            action: call-service
                            service: shell_command.unraid_powerdown
                  entities:
                    - entity: binary_sensor.rt_ac86u_internet
                      name: Internet Status
                    - entity: switch.rt_ac86u_openvpn_server_2
                      secondary_info: none
                      name: VPN (All Access)
                  title-card:
                    type: custom:bubble-card
                    column_fix: true
                    card_type: separator
                    icon: mdi:cog
                    name: Quick Controls
                    entity: switch.unraid_server_mazmaka_mazmaka_docker_swag
                    card_mod:
                      style: |
                        .separator-container {
                          display: inline-flex;
                          align-items: center;
                          justify-content: center;
                          width: 100%;
                          margin-top: 12px;
                        }
                        .separator-container div:last-child {
                          display: none;
                        }
                  card_mod:
                    style: |
                      .header {
                        color: white;  /* Custom header text color */
                        font-weight: bold;  /* Make the text bold */
                        font-size: 18px;  /* Adjust font size */
                      }
                      .primary.title.svelte-1n379ek {
                        text-align: center;  /* Center-align the specific div text */
                      }
          - type: conditional
            conditions:
              - condition: state
                entity: sensor.unraid_server_mazmaka_mazmaka_cpu_usage
                state: unavailable
            card:
              type: vertical-stack
              cards:
                - type: markdown
                  content: >-
                    The server is currently **turned off!**


                    You can use the button below to turn this on and the screen
                    will automatically refresh
                  card_mod:
                    style:
                      mushroom-shape-avatar$: |
                        .picture {
                          /* Style shadow ring around person avatar */                              
                          box-shadow: 0px 0px 8px 4px var(--state-person);
                          margin-right: var(--mush-title-spacing, 12px);
                          }
                      .: |
                        ha-card {
                          /* Remove default card styling */
                          --ha-card-background: rgba(var(--rgb-card-background-color), 0.);;
                          box-shadow: none;
                          --ha-card-border-width: 0;
                          /* Increase icon size */
                          --icon-size: 80px;
                          /* Center card */
                          margin: 25px 0px 0px 30px;
                          width: fit-content;
                          /* Add padding to bottom of card */
                          padding: 0px 0px var(--mush-title-spacing, 12px) 0px !important;
                          
                          /* Make card non-responsive to select and pointer */
                          user-select: none;
                          pointer-events: none;
                          
                          transition: all 0s;
                        }
                        :host {
                          /* Define Person State colors. Can be added to theme */
                          --state-person-home: var(--green-color);
                          --state-person-not-home: var(--red-color);
                          --state-person-zone: var(--blue-color);
                          --state-person-unknown: var(--grey-color);
                          /* Set Person State color */
                          --state-person:
                          {% if is_state(config.entity, ['home', 'not_home', 'unknown']) %}
                            var(--state-person-{{ states(config.entity) | replace('_', '-') }})
                          {% else %}
                            var(--state-person-zone)
                          {% endif %};
                          /* Match styling to Mushroom Title */
                          --mush-card-primary-font-size: var(--mush-title-font-size, 24px);
                          --mush-card-primary-font-weight: var(--mush-title-font-weight, normal);
                          --mush-card-primary-line-height: var(--ush-title-line-height, 1.2);
                          --mush-card-secondary-font-size: var(--mush-title-font-size, 16px);
                          --mush-card-secondary-font-weight: var(--mush-title-font-weight, normal);
                          --mush-card-secondary-line-height: var(--ush-title-line-height, 1.2);
                        }
                - type: custom:bubble-card
                  card_type: button
                  button_type: switch
                  entity: switch.server
                  icon: mdi:server
                  show_state: true
                  name: Server
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#ha"
            show_header: true
            name: ""
            show_icon: false
            show_attribute: false
            show_state: true
            show_last_changed: false
            tap_action:
              action: none
            double_tap_action:
              action: none
            hold_action:
              action: none
            button_action:
              tap_action:
                action: none
              double_tap_action:
                action: none
              hold_action:
                action: none
            scrolling_effect: true
            styles: |-
              .bubble-header .bubble-name-container {
                align-items: center;
              }

              }
            auto_close: ""
            hide_backdrop: false
            button_type: name
            show_name: true
          - type: custom:bubble-card
            column_fix: true
            card_type: separator
            icon: mdi:raspberry-pi
            name: HomeAssistant Monitor
            entity: person.craig_archbold
            card_mod:
              style: |
                .separator-container {
                        display: inline-flex;
                        align-items: center;
                        justify-content: center;
                        width: 100%;
                        margin-top: 12px;
                    }
                    .separator-container div:last-child {
                        display: none;
                    }
          - type: custom:vertical-stack-in-card
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mini-graph-card
                    entities:
                      - sensor.system_monitor_processor_use
                    name: CPU
                    line_color: "#3123b9"
                    line_width: 2
                    hours_to_show: 24
                  - type: custom:mini-graph-card
                    entities:
                      - sensor.system_monitor_processor_temperature
                    name: Temp
                    line_color: "#d080b9"
                    line_width: 2
                    hours_to_show: 24
              - type: custom:mini-graph-card
                entities:
                  - sensor.system_monitor_memory_use_percent
                name: Memory
                line_color: "#2980b9"
                line_width: 2
                hours_to_show: 24
              - type: custom:bar-card
                name: CPU
                positions:
                  icon: outside
                  name: inside
                color: "#3123b9"
                entities:
                  - entity: sensor.system_monitor_processor_use
              - type: custom:bar-card
                name: CPU Temp
                positions:
                  icon: outside
                  name: inside
                color: "#00ba6a"
                entities:
                  - entity: sensor.system_monitor_processor_temperature
              - type: custom:bar-card
                name: RAM
                positions:
                  icon: outside
                  name: inside
                entities:
                  - entity: sensor.system_monitor_memory_use_percent
              - type: tile
                entity: sensor.system_monitor_ipv4_address_end0
                name: IP Address
                tap_action:
                  action: url
                  url_path: http://192.168.1.175:8123
                icon_tap_action:
                  action: none
                hold_action:
                  action: none
                vertical: true
      - type: custom:button-card
        color_type: blank-card
        card_mod:
          style: |
            ha-card {
                   margin-bottom: 5em;
            }
      - type: conditional
        conditions:
          - condition: screen
            media_query: "(min-width: 0px) and (max-width: 1023px)"
        card:
          type: custom:mushroom-chips-card
          chips:
            - type: back
            - type: template
              icon: mdi:lightbulb
              content: >-
                {{ expand(states.light) | selectattr( 'state', 'eq', 'on') |
                list | count }}
              entity: light.all_lights
              icon_color: yellow
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.popup
                  data:
                    theme: noctis
                    title: Active Lights
                    content:
                      type: vertical-stack
                      cards:
                        - type: custom:auto-entities
                          card:
                            square: false
                            type: grid
                            columns: 1
                          card_param: cards
                          filter:
                            exclude:
                              - state: "off"
                              - entity_id: light.all_lights
                              - entity_id: light.downstairs_main_lights
                              - entity_id: light.upstairs_main_lights
                              - entity_id: light.sitting_room_lamps
                              - entity_id: light.all_main_lights
                            include:
                              - domain: light
                                options:
                                  type: custom:bubble-card
                                  icon: mdi:lightbulb-on
                                  card_type: button
                                  button_type: switch
                                  entities:
                                    - sensor.0x00124b002502bdf5_battery
                          sort:
                            method: friendly_name
            - type: conditional
              conditions:
                - condition: state
                  entity: binary_sensor.front_door_sensor_contact
                  state: "on"
              chip:
                type: entity
                entity: binary_sensor.front_door_sensor_contact
                tap_action:
                  action: more-info
                hold_action:
                  action: more-info
                double_tap_action:
                  action: more-info
                content_info: none
                icon: mdi:door-open
                icon_color: red
                name: Front Door
            - type: spacer
            - type: entity
              entity: person.craig_archbold
              tap_action:
                action: navigate
                navigation_path: /dashboard-mobile/0
              hold_action:
                action: navigate
                navigation_path: /dashboard-mobile/0
              icon: mdi:home
              content_info: none
            - type: spacer
            - type: entity
              entity: person.craig_archbold
              tap_action:
                action: navigate
                navigation_path: /dashboard-mobile/calendar
              hold_action:
                action: navigate
                navigation_path: /dashboard-mobile/calendar
              icon: mdi:calendar
              content_info: none
              double_tap_action:
                action: navigate
                navigation_path: /dashboard-mobile/calendar
            - type: conditional
              conditions:
                - condition: state
                  entity: calendar.green_bin
                  state: "on"
              chip:
                type: action
                icon: mdi:trash-can-outline
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-mobile/bin-calendar
                hold_action:
                  action: navigate
                  navigation_path: /dashboard-mobile/bin-calendar
                double_tap_action:
                  action: navigate
                  navigation_path: /dashboard-mobile/bin-calendar
            - type: conditional
              conditions:
                - condition: state
                  entity: calendar.blue_bin
                  state: "on"
              chip:
                type: action
                icon: mdi:recycle
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-mobile/bin-calendar
                hold_action:
                  action: navigate
                  navigation_path: /dashboard-mobile/bin-calendar
                double_tap_action:
                  action: navigate
                  navigation_path: /dashboard-mobile/bin-calendar
            - type: conditional
              conditions:
                - condition: state
                  entity: calendar.birthdays
                  state: "on"
              chip:
                type: action
                icon: mdi:cake-variant-outline
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-mobile/calendar
                hold_action:
                  action: navigate
                  navigation_path: /dashboard-mobile/calendar
                double_tap_action:
                  action: navigate
                  navigation_path: /dashboard-mobile/calendar
            - type: conditional
              conditions:
                - condition: state
                  entity: binary_sensor.back_door_sensor_contact
                  state: "on"
              chip:
                type: entity
                entity: binary_sensor.back_door_sensor_contact
                tap_action:
                  action: more-info
                hold_action:
                  action: more-info
                double_tap_action:
                  action: more-info
                content_info: none
                icon: mdi:door-open
                icon_color: red
                name: Back Door
            - type: menu
          alignment: justify
          card_mod:
            style: |
              ha-card {
                --chip-background: #34495E;
                z-index: 2;
                position: fixed;
                bottom: 0;
                padding: 12px 20px;
                background: #34495E !important;
                box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.3);
                margin: 0 !important;
                left: 50%;
                transform: translateX(-50%);
                width: 100%;
                border-top-left-radius: 12px;
                border-top-right-radius: 12px;
              }
              .mushroom-conditional-chip {
                transition: background 0.3s, color 0.3s;
              }
              .mushroom-entity-chip ha-state-icon {
                color: #ecf0f1;
              }
              .mushroom-action-chip ha-state-icon {
                color: #ecf0f1;
              }
              /* Removed ping animations for a more professional look */
title: Health
cards: []
